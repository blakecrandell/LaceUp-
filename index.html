<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LaceUp v9.0.2 — Demo+Live</title>
<style>:root{--line:#e8eaef;--brand:#e65a28;--ink:#fff;--bg:#fafafa}*{box-sizing:border-box}html,body{height:100%}body{margin:0;font-family:system-ui,Segoe UI,Roboto,Arial;background:var(--bg);color:#0f172a}
header{display:flex;align-items:center;gap:12px;padding:12px 16px;background:#fff;border-bottom:1px solid var(--line);position:sticky;top:0;z-index:20}.brand{font-weight:900}.burger{width:40px;height:40px;border-radius:10px;border:1px solid var(--line);display:flex;align-items:center;justify-content:center;cursor:pointer;background:#fff}.banner{background:#fef3c7;color:#92400e;border:1px solid #fde68a;border-radius:10px;padding:8px 10px;font-size:13px;margin-left:auto}
.container{display:flex;min-height:calc(100% - 58px)}aside{width:280px;max-width:80vw;background:#fff;border-right:1px solid var(--line);padding:12px;position:fixed;left:0;top:58px;bottom:0;transform:translateX(-100%);transition:transform .2s ease}aside.open{transform:translateX(0)}
nav a{display:block;padding:10px 12px;border-radius:10px;text-decoration:none;color:#0f172a;border:1px solid transparent;margin:4px 0;font-weight:700}nav a.active{border-color:var(--brand);color:#e65a28}
main{flex:1;max-width:1100px;margin:0 auto;padding:12px}.card{border:1px solid var(--line);border-radius:14px;padding:12px;margin:12px 0;background:#fff}.row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}.col{display:grid;gap:8px}
.btn{background:var(--brand);color:var(--ink);border:none;border-radius:10px;padding:8px 12px;font-weight:800;cursor:pointer}.btn.ghost{background:#fff;color:#0f172a;border:1px solid var(--line)}
input,select,textarea{border:1px solid var(--line);border-radius:10px;padding:8px 10px;font-size:16px}.small{font-size:12px;color:#64748b}.hidden{display:none}.badge{border:1px solid var(--line);border-radius:999px;padding:2px 8px;font-size:12px;background:#fff}
.cal-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}.cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:4px}.dow{font-size:11px;text-transform:uppercase;color:#6b7280;text-align:center}
.cell{border:1px solid var(--line);border-radius:10px;padding:4px;min-height:68px;background:#fff;display:flex;flex-direction:column;gap:2px;position:relative}.cell .date{font-weight:900;font-size:11px}.cell .evline{font-size:10px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.overflow{position:absolute;right:6px;bottom:4px;font-weight:900}.today{outline:2px solid var(--brand);outline-offset:-2px}
@media (max-width:420px){ .cell{min-height:60px} .cell .date{font-size:10px} .cell .evline{font-size:9.5px} }
.pop{position:fixed;min-width:280px;max-width:92vw;background:#fff;border:1px solid var(--line);border-radius:12px;box-shadow:0 12px 28px rgba(0,0,0,.18);padding:10px;display:none;z-index:60}.pop .ev{border:1px solid var(--line);border-radius:10px;padding:8px;margin:6px 0;background:#fff}.pop .when{font-size:12px;color:#6b7280}.closex{position:absolute;right:8px;top:8px;cursor:pointer;color:#6b7280}
.chatWrap{display:grid;gap:10px}.pin{background:#fff7ed;border:1px solid #fed7aa;border-radius:12px;padding:10px}.pin h3{margin:0 0 6px 0}.msg{display:flex;gap:8px;margin:8px 0}.bubble{background:#f8fafc;border:1px solid var(--line);border-radius:14px;padding:8px 10px;max-width:80%}.me .bubble{background:#eff6ff;border-color:#dbeafe}.msg .meta{font-size:11px;color:#64748b;margin-top:2px}
.inputRow{display:flex;gap:6px;margin-top:6px}.inputRow input[type="text"]{flex:1}.clock{font-size:32px;font-weight:900}.pill{padding:6px 10px;border:1px solid var(--line);border-radius:999px;background:#fff;margin:3px;display:inline-block;cursor:pointer}.pill.on{background:#dcfce7;border-color:#86efac}.pill.lock{background:#fee2e2;border-color:#fecaca}
</style></head><body>
<header><div class="burger" id="burger">☰</div><div class="brand">LaceUp v9.0.2</div><div class="banner" id="modeBanner">Loading…</div></header>
<div class="container"><aside id="drawer"><nav>
<a href="#home" class="nav-link active">Home</a><a href="#calendar" class="nav-link">Calendar</a><a href="#team" class="nav-link">Team</a><a href="#builder" class="nav-link">Builder</a><a href="#athome" class="nav-link">At‑Home</a><a href="#gameday" class="nav-link">Game Day</a><a href="#chat" class="nav-link">Chat</a><a href="#setup" class="nav-link">Setup</a>
</nav></aside><main>
<section id="home" class="page"><div class="card"><div class="row" style="justify-content:space-between;align-items:center">
<div class="row" style="gap:10px;align-items:center"><img id="crest" src="" style="width:44px;height:44px;border-radius:8px;border:1px solid var(--line);object-fit:cover;background:#fff"/>
<div><div id="teamName" style="font-weight:900">Your Team</div><div class="small" id="ageBand">—</div></div></div>
<div class="row"><button class="btn ghost" id="goChat">Open Chat</button><button class="btn ghost" id="goSetup">Team setup</button></div>
</div></div><div class="card"><h2 style="margin:0 0 8px 0">Upcoming</h2><div id="upcoming"></div></div></section>
<section id="calendar" class="page hidden"><div class="card"><div class="cal-head"><div class="row"><button class="btn ghost" id="prevMonth">◀</button><div id="calTitle" style="font-weight:900"></div><button class="btn ghost" id="nextMonth">▶</button></div></div><div class="cal-grid" id="calGrid"></div></div></section>
<section id="team" class="page hidden"><div class="card"><h1>Roster</h1><div class="row"><input id="playerNum" placeholder="#" style="width:80px"><input id="playerName" placeholder="Player name" style="flex:1"><button class="btn" id="addPlayer">Add</button></div><div id="rosterList" style="margin-top:8px"></div></div></section>
<section id="builder" class="page hidden"><div class="card"><h1>Session Builder</h1><div class="row"><select id="ageBandSel"><option>4–6</option><option>6–8</option><option>9–11</option><option>12–14</option><option>15–18</option></select><select id="level"><option>Beginner</option><option>Intermediate</option><option>Advanced</option></select><input id="duration" type="number" value="60" min="30" max="120" style="width:120px"><span class="small">mins</span></div><div class="row" id="focusWrap"></div><div class="row"><button class="btn" id="genSession">Generate session</button></div></div><div class="card"><h2>Plan</h2><div id="sessionOut" class="small"></div></div></section>
<section id="athome" class="page hidden"><div class="card"><h1>At‑Home Planner</h1><div id="athomeOut" class="small"></div></div></section>
<section id="gameday" class="page hidden"><div class="card"><h1>Game Day — Simple</h1>
<div class="row" style="gap:16px;align-items:baseline"><label>Half <input id="halfMin" type="number" value="20" min="5" max="45" style="width:80px"> min</label><label>Sub every <input id="subMin" type="number" value="6" min="2" max="20" style="width:80px"> min</label><label>On‑field <input id="onField" type="number" value="7" min="4" max="30" style="width:80px"></label><label>GK <select id="gkSelect"><option value="">—</option></select></label></div>
<div class="row" style="align-items:baseline;gap:16px"><div class="clock" id="matchClock">00:00</div><div class="small" id="halfLabel">Half 1</div></div>
<div class="row"><button class="btn" id="startStop">Start</button><button class="btn ghost" id="nextSub">Next Sub</button><button class="btn ghost" id="resetClock">Reset</button></div><div id="rotPills" style="margin-top:6px"></div>
</div></section>
<section id="chat" class="page hidden"><div class="card chatWrap"><div class="pin"><h3>Announcements</h3><div id="annList" class="small">—</div></div>
<div class="card" style="margin:0"><h3 style="margin:0 0 6px 0">Team Chat</h3><div id="chatList"></div><div class="inputRow"><input id="chatName" placeholder="Your name (once)" style="max-width:180px"><input id="chatText" placeholder="Type a message…"><button class="btn" id="sendChat">Send</button></div><div class="small">Announcements are pinned above and visually distinct.</div></div></div></section>
<section id="setup" class="page hidden"><div class="card"><h1>Team setup</h1><div class="col"><label>Name <input id="tName"></label><label>Age band <select id="tAge"><option>4–6</option><option>6–8</option><option>9–11</option><option>12–14</option><option>15–18</option></select></label><label>Crest URL <input id="tCrest" placeholder="https://…"></label><label>Primary color <input id="tColor" value="#e65a28" type="color" style="width:80px;height:40px;padding:0;border-radius:8px"></label></div></div>
<div class="card"><h2>Season generator</h2><div class="row"><label>Start date <input id="sgStart" type="date"></label><label>Weeks <input id="sgWeeks" type="number" value="18" min="1" max="40" style="width:90px"></label></div>
<div class="col" id="trainRows" style="margin-top:8px"><div class="row sgTrain"><strong>Training</strong><select class="sgDOW"><option>Mon</option><option>Tue</option><option>Wed</option><option>Thu</option><option>Fri</option></select><input class="sgTime" type="time" value="17:00"><input class="sgLoc" placeholder="Location"><button class="btn ghost addTrain" type="button">+ Add</button></div></div>
<div class="row" style="margin-top:6px"><strong>Match</strong><select id="sgMatchDOW"><option>Sat</option><option>Sun</option></select><input id="sgMatchTime" type="time" value="09:00"><input id="sgMatchLoc" placeholder="Location"></div>
<div class="row" style="margin-top:8px"><label>Skip dates (comma YYYY-MM-DD) <input id="sgSkip" style="min-width:260px"></label></div>
<div class="row" style="margin-top:8px"><button class="btn" id="sgRun" type="button">Generate season</button><div class="small" id="sgOut"></div></div></div></section>
</main></div>
<div class="pop" id="dayPop"><div class="closex" id="popClose">✕</div><div id="popTitle" style="font-weight:900;margin-bottom:6px">Day</div><div id="popList"></div></div>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.js"></script>
<script>
const $=(s)=>document.querySelector(s), $$=(s)=>Array.from(document.querySelectorAll(s));
const drawer=$('#drawer'); $('#burger').onclick=()=>drawer.classList.toggle('open');
$$('.nav-link').forEach(a=>a.onclick=(e)=>{e.preventDefault(); const id=a.getAttribute('href').slice(1); showPage(id); drawer.classList.remove('open');});
function showPage(id){ $$('.nav-link').forEach(x=>x.classList.toggle('active', x.getAttribute('href')==='#'+id)); $$('.page').forEach(p=>p.classList.add('hidden')); document.getElementById(id).classList.remove('hidden'); }
showPage('home'); $('#goSetup').onclick=()=>showPage('setup'); $('#goChat').onclick=()=>showPage('chat');
function ymd(d){ const x=new Date(d); return x.getFullYear()+'-'+String(x.getMonth()+1).padStart(2,'0')+'-'+String(x.getDate()).padStart(2,'0'); }
function fmtTimeAMPM(d){ const dt=new Date(d); let s=dt.toLocaleTimeString([], {hour:'numeric', minute:'2-digit', hour12:true}); s=s.replace(/\s?am/i,' AM').replace(/\s?pm/i,' PM'); return s; }
const DemoStore={_mem:{team:{name:'Falcons U8',age_band:'6–8'},players:[],events:[],chats:[]},
async team(){return this._mem.team;},async upsertTeam(t){this._mem.team={...this._mem.team,...t};},async players(){return this._mem.players;},async addPlayer(p){this._mem.players.push({...p,id:crypto.randomUUID()});},
async eventsBetween(start,end){return this._mem.events.filter(e=>new Date(e.starts_at)>=start&&new Date(e.starts_at)<end);},
async addEvent(e){this._mem.events.push({...e,id:crypto.randomUUID()});},
async chats(){return this._mem.chats;},async addChat(c){this._mem.chats.push({...c,id:crypto.randomUUID(),created_at:new Date().toISOString()});}};
(()=>{const now=new Date();const d1=new Date(now);d1.setDate(d1.getDate()+1);d1.setHours(17,0,0,0);const d2=new Date(now);d2.setDate(d2.getDate()+3);d2.setHours(17,0,0,0);const d3=new Date(now);d3.setDate(d3.getDate()+5);d3.setHours(9,0,0,0);
DemoStore._mem.events.push({type:'Training',title:'Training',starts_at:d1.toISOString(),location:'Main Park'});
DemoStore._mem.events.push({type:'Training',title:'Training',starts_at:d2.toISOString(),location:'Main Park'});
DemoStore._mem.events.push({type:'Match',title:'Matchday',starts_at:d3.toISOString(),location:'Pitch 2'});})();
let Live=null;(async()=>{const mode=$('#modeBanner');try{const url="https://brnnxaehkrfaudowpayg.supabase.co";const anon="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJybm54YWVoa3JmYXVkb3dwYXlnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ5NDQ5NTIsImV4cCI6MjA3MDUyMDk1Mn0.ldktaXM0XQ8UX_aABNcqueRoNyqgW410uQXAAKF0csw";const sb=window.supabase.createClient(url,anon);const probe=await sb.from('teams').select('id').limit(1);if(probe.error) throw probe.error;Live={sb};mode.textContent="Live mode (Supabase)";}catch(e){console.warn('Falling back to demo',e);mode.textContent="Demo mode (offline sample data)";bootDemo();}})();
async function bootDemo(){await fillHomeDemo();await refreshMonthDemo();await renderRosterDemo();renderAtHome();wireBuilder();wireGameday();wireChatDemo();wireSetupDemo();}
async function fillHomeDemo(){const t=await DemoStore.team();$('#teamName').textContent=t.name||'Your Team';$('#ageBand').textContent=t.age_band||'—';const now=new Date(),end=new Date(now);end.setMonth(end.getMonth()+1);const evs=await DemoStore.eventsBetween(now,end);
$('#upcoming').innerHTML=(evs||[]).sort((a,b)=>new Date(a.starts_at)-new Date(b.starts_at)).slice(0,3).map(e=>`<div class="row" style="justify-content:space-between;border:1px solid var(--line);border-radius:10px;padding:6px 8px;background:#fff"><div><strong>${e.type}</strong> — ${fmtTimeAMPM(e.starts_at)}</div><div class="small">${e.location||''}</div></div>`).join('')||'<div class="small">No upcoming events.</div>';}
let calMonth=new Date();calMonth.setDate(1);let monthEvents=[];async function fetchMonthDemo(){const start=new Date(calMonth),end=new Date(calMonth);end.setMonth(end.getMonth()+1);monthEvents=await DemoStore.eventsBetween(start,end);}
function drawMonth(){$('#calTitle').textContent=calMonth.toLocaleString([],{month:'long',year:'numeric'});const grid=$('#calGrid');grid.innerHTML='';const dows=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];for(const d of dows){const h=document.createElement('div');h.className='dow';h.textContent=d;grid.appendChild(h);}const firstDow=new Date(calMonth).getDay();for(let i=0;i<firstDow;i++){const c=document.createElement('div');c.className='cell';c.style.visibility='hidden';grid.appendChild(c);}const daysInMonth=new Date(calMonth.getFullYear(),calMonth.getMonth()+1,0).getDate();const todayStr=ymd(new Date());
for(let d=1;d<=daysInMonth;d++){const dateStr=ymd(new Date(calMonth.getFullYear(),calMonth.getMonth(),d));const cell=document.createElement('div');cell.className='cell';if(dateStr===todayStr)cell.classList.add('today');const head=document.createElement('div');head.className='date';head.textContent=d;cell.appendChild(head);const evs=monthEvents.filter(e=>ymd(e.starts_at)===dateStr);let shown=0;for(const e of evs){if(shown>=2)break;const line=document.createElement('div');line.className='evline';line.textContent=`${e.type} • ${fmtTimeAMPM(e.starts_at)}`;cell.appendChild(line);shown++;}if(evs.length>shown){const more=document.createElement('div');more.className='small overflow';more.textContent='+';cell.appendChild(more);}cell.onclick=()=>openDay(dateStr,cell.getBoundingClientRect());grid.appendChild(cell);}}
function openDay(dateStr,rect){const list=monthEvents.filter(e=>ymd(e.starts_at)===dateStr);$('#popTitle').textContent=new Date(dateStr).toDateString();$('#popList').innerHTML=list.map(e=>`<div class="ev"><div><strong>${e.type}</strong> — ${fmtTimeAMPM(e.starts_at)}</div><div class="small">${e.location||''}</div></div>`).join('')||'<div class="small">No events.</div>';const pop=$('#dayPop');pop.style.display='block';let x=rect.left+window.scrollX,y=rect.bottom+window.scrollY+6;const w=320;if(x+w>innerWidth)x=innerWidth-w-10;pop.style.left=Math.max(8,x)+'px';pop.style.top=Math.max(8,y)+'px';}
$('#popClose').onclick=()=>$('#dayPop').style.display='none';$('#prevMonth').onclick=()=>{calMonth.setMonth(calMonth.getMonth()-1);refreshMonthDemo();};$('#nextMonth').onclick=()=>{calMonth.setMonth(calMonth.getMonth()+1);refreshMonthDemo();};async function refreshMonthDemo(){await fetchMonthDemo();drawMonth();}
async function renderRosterDemo(){const data=await DemoStore.players();const list=$('#rosterList');list.innerHTML=(data||[]).map(p=>`<div class="row" style="justify-content:space-between;border:1px solid var(--line);border-radius:10px;padding:6px 8px;background:#fff"><div>${p.number?'<span class="badge">#'+p.number+'</span> ':''}${p.name}</div></div>`).join('')||'<div class="small">No players yet.</div>';}
$('#addPlayer').onclick=async()=>{const n=$('#playerName').value.trim();const num=$('#playerNum').value.trim()||null;if(!n)return;await DemoStore.addPlayer({name:n,number:num});$('#playerName').value='';$('#playerNum').value='';renderRosterDemo();};
const DRILLS=[['dribble1','Red Light, Green Light',4,8,'Beginner',['dribbling','fun'],8,'10x15m lane','cones, balls','Stop/start control, head up','lane-stop'],['dribble2','Cone Slalom',6,12,'Beginner',['dribbling'],10,'10x10m zig-zag','6–8 cones, 1 ball/player','Both feet, close touches','zigzag'],['pass1','Gate Passing',7,12,'Beginner',['passing'],12,'20x20m area w/ gates','20 cones, balls','Pass & move, first touch out of feet','gates'],['rondo1','3v1 Rondo',8,18,'Intermediate',['passing','first-touch'],12,'10x10m square','4 cones, 1 ball','Two-touch max, body shape','rondo'],['finish1','Finish & Recover',8,18,'All',['shooting'],12,'Penalty box','ball stash at top','Quick shot after touch, rebounds','shoot'],['game1','Small‑Sided Game',6,18,'All',['game'],15,'30x20m','bibs, cones, balls','Let them play to theme','ssg']].map(d=>({id:d[0],name:d[1],ageMin:d[2],ageMax:d[3],level:d[4],tags:d[5],dur:d[6],setup:d[7],equip:d[8],points:d[9],diagram:d[10]}));
const TAGS=['dribbling','passing','shooting','first-touch','1v1','defending','fitness','game'];$('#focusWrap').innerHTML=TAGS.map(t=>`<label><input type="checkbox" class="focus" value="${t}" checked> ${t}</label>`).join(' ');
function chooseDrills(ageText,level,duration,focuses){const[lo,hi]=ageText.split('–').map(x=>parseInt(x,10));const pool=DRILLS.filter(d=>d.ageMin<=hi&&d.ageMax>=lo&&(level==='All'||d.level===level||d.level==='All')&&(focuses.length===0||focuses.some(t=>d.tags.includes(t))));const plan=[];let time=0;const used=new Set();const shuffled=[...pool].sort(()=>Math.random()-0.5);
for(const d of shuffled){if(used.has(d.id))continue;if(time+d.dur>duration)continue;plan.push(d);used.add(d.id);time+=d.dur;if(time>=duration-6)break;}if(time<duration){const ssg=pool.find(x=>x.tags.includes('game'))||DRILLS.find(x=>x.id==='game1');plan.push({...ssg,dur:Math.max(6,duration-time)});}return plan;}
function renderPlan(drills){$('#sessionOut').innerHTML=drills.map((d,i)=>`<details class="card"><summary><strong>${i+1}. ${d.name}</strong> — ${d.dur} min</summary><div class="small">Focus: ${d.tags.join(', ')}</div><div class="small">Setup: ${d.setup}</div><div class="small">Equipment: ${d.equip}</div><div class="small">Coaching: ${d.points}</div><div class="small" style="border:1px dashed var(--line);border-radius:10px;padding:8px;margin-top:6px">diagram: ${d.diagram}</div></details>`).join('');}
function wireBuilder(){$('#genSession').onclick=()=>{const age=$('#ageBandSel').value,level=$('#level').value,dur=parseInt($('#duration').value||'60',10);const focuses=$$('.focus').filter(c=>c.checked).map(c=>c.value);renderPlan(chooseDrills(age,level,dur,focuses));};}
function renderAtHome(){const plan=chooseDrills('6–8','Beginner',40,['dribbling','passing']);$('#athomeOut').innerHTML=plan.map((d,i)=>`Day ${i+1}: <strong>${d.name}</strong> (${d.dur}m) — <span class="small">${d.points}</span>`).join('<br>');}
let roster=[],onSet=new Set(),gkId=null,ticking=false,tStart=0,elapsed=0;
function wireGameday(){function renderPills(){const box=$('#rotPills');box.innerHTML=(roster||[]).map(p=>`<span class="pill ${onSet.has(p.id)?'on':''} ${p.id===gkId?'lock':''}" data-id="${p.id}">${p.number?('#'+p.number+' '):''}${p.name}${p.id===gkId?' • GK':''}</span>`).join('');box.querySelectorAll('.pill').forEach(el=>el.onclick=()=>{const id=el.dataset.id;if(id===gkId)return;if(onSet.has(id))onSet.delete(id);else onSet.add(id);el.classList.toggle('on');});}
roster=[{id:'1',name:'Ava',number:7},{id:'2',name:'Leo',number:9},{id:'3',name:'Mia',number:3},{id:'4',name:'Noah',number:1},{id:'5',name:'Zoe',number:5}];
$('#gkSelect').innerHTML='<option value="">—</option>'+roster.map(p=>`<option value="${p.id}">${p.number?('#'+p.number+' '):''}${p.name}</option>`).join('');$('#gkSelect').onchange=()=>{gkId=$('#gkSelect').value||null;renderPills();};
setInterval(()=>{if(ticking)elapsed=(Date.now()-tStart)/1000;$('#matchClock').textContent=fmtClock(elapsed);},500);
$('#startStop').onclick=()=>{if(!ticking){tStart=Date.now()-elapsed*1000;ticking=True;$('#startStop').textContent='Pause';}else{ticking=False;$('#startStop').textContent='Start';}};
$('#resetClock').onclick=()=>{ticking=false;elapsed=0;$('#startStop').textContent='Start';};
$('#nextSub').onclick=()=>{const field=roster.filter(p=>onSet.has(p.id)&&p.id!==gkId);const bench=roster.filter(p=>!onSet.has(p.id)&&p.id!==gkId);if(!field.length||!bench.length)return;onSet.delete(field[0].id);onSet.add(bench[0].id);renderPills();};
function fmtClock(s){const m=Math.floor(s/60),ss=String(Math.floor(s%60)).padStart(2,'0');return String(m).padStart(2,'0')+':'+ss;}renderPills();}
function wireChatDemo(){$('#annList').innerHTML=`<div class="msg"><div class="bubble"><div>Welcome to LaceUp! This is a demo announcement.</div><div class="meta">Coach • ${new Date().toLocaleString()}</div></div></div>`;$('#sendChat').onclick=()=>{const name=$('#chatName').value.trim()||'Parent';const text=$('#chatText').value.trim();if(!text)return;const now=new Date().toLocaleTimeString([], {hour:'numeric',minute:'2-digit'});const cur=$('#chatList').innerHTML;$('#chatList').innerHTML=cur+`<div class="msg me"><div class="bubble"><div>${text}</div><div class="meta">${name} • ${now}</div></div></div>`;$('#chatText').value='';$('#chatList').scrollTop=999999;};}
function wireSetupDemo(){const today=new Date();$('#sgStart').value=today.toISOString().slice(0,10);
document.getElementById('trainRows').addEventListener('click',(e)=>{if(e.target.classList.contains('addTrain')){const row=document.createElement('div');row.className='row sgTrain';row.innerHTML='<strong>Training</strong><select class="sgDOW"><option>Mon</option><option>Tue</option><option>Wed</option><option>Thu</option><option>Fri</option></select><input class="sgTime" type="time" value="17:00"><input class="sgLoc" placeholder="Location"><button class="btn ghost removeTrain" type="button">Remove</button>';document.getElementById('trainRows').appendChild(row);}if(e.target.classList.contains('removeTrain')) e.target.closest('.sgTrain').remove();});
document.getElementById('sgRun').addEventListener('click',async()=>{const startStr=$('#sgStart').value;if(!startStr){alert('Choose a start date');return;}const start=new Date(startStr+'T00:00:00');const weeks=parseInt($('#sgWeeks').value||'18',10);const dowIdx={'Sun':0,'Mon':1,'Tue':2,'Wed':3,'Thu':4,'Fri':5,'Sat':6};const skip=($('#sgSkip').value||'').split(',').map(s=>s.trim()).filter(Boolean);let created=0;
const trains=Array.from(document.querySelectorAll('.sgTrain')).map(r=>({dow:r.querySelector('.sgDOW').value,time:r.querySelector('.sgTime').value,loc:r.querySelector('.sgLoc').value}));
for(let w=0;w<weeks;w++){const base=new Date(start);base.setDate(base.getDate()+w*7);for(const tr of trains){const d=new Date(base);const cur=d.getDay(),want=dowIdx[tr.dow];d.setDate(d.getDate()+((want-cur+7)%7));const[hh,mm]=tr.time.split(':');d.setHours(parseInt(hh),parseInt(mm),0,0);const y=ymd(d);if(skip.includes(y))continue;await DemoStore.addEvent({type:'Training',title:'Training',starts_at:d.toISOString(),location:tr.loc});created++;}
const mdow=$('#sgMatchDOW').value;const mt=new Date(base);const cur=mt.getDay(),want=dowIdx[mdow];mt.setDate(mt.getDate()+((want-cur+7)%7));const[mh,mm]=($('#sgMatchTime').value||'09:00').split(':');mt.setHours(parseInt(mh),parseInt(mm),0,0);const y2=ymd(mt);if(!skip.includes(y2)){await DemoStore.addEvent({team_id:'demo',type:'Match',title:'Matchday',starts_at:mt.toISOString(),location:$('#sgMatchLoc').value});created++;}}
$('#sgOut').textContent='Created '+created+' events (demo mode).';await refreshMonthDemo();});}
function refreshAll(){fillHomeDemo();refreshMonthDemo();}
</script></body></html>
